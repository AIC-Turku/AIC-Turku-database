schema_version: 1
record_type: qc_session

qc_id: "qc_scope-testx1_20250902T1530Z_intensity_v1"
microscope: "scope-testx1"

started_utc: "2025-09-02T15:30:00Z"
ended_utc: "2025-09-02T16:20:00Z"

performed_by: "Elina Vainio"
reason: "troubleshooting"
summary: "QC confirmed intermittent 561 channel dropouts with unstable output during time-lapse simulation."
notes: >
  488 and 640 remained stable. 561 output dipped to ~40% twice during 20 min run, supporting LED driver fault diagnosis.

performed:
  - qc_type: "laser_power"
    details: "Linearity and 20-minute stability check at objective plane."
    artifacts: ["art_laser_linearity_csv", "art_laser_stability_csv"]
  - qc_type: "psf"
    details: "175 nm bead stack in 488 channel."
    artifacts: ["art_psf_stack_raw", "art_psf_preview"]
  - qc_type: "alignment"
    details: "Multicolor bead co-registration check (488/561)."
    artifacts: ["art_coreg_stack_raw", "art_coreg_preview"]
  - qc_type: "stage"
    details: "Stage repeatability assay over 100 cycles."
    artifacts: ["art_stage_repeat_raw", "art_stage_repeat_plot"]

inputs_human:
  - metric_id: "visual.optics_clean"
    value: "yes"
    unit: ""
    details: "No visible residue on objective front lens."

laser_inputs_human:
  measurement_position: "at_objective"
  measurement_position_details: "60x/1.4 objective with calibrated photodiode adapter."
  power_meter:
    model: "Thorlabs PM100D + S170C"
    serial: "PMD-AX41-228"
    calibration_due: "2026-12-31"
    integration_time_s: 1.0
    notes: "Room temp 22 C, humidity 41%."
  linearity_series:
    - laser: "488"
      setpoint_units: "percent"
      power_units: "mW"
      points:
        - setpoint: 10
          power: 0.22
        - setpoint: 20
          power: 0.44
        - setpoint: 50
          power: 1.10
        - setpoint: 100
          power: 2.18
      csv_artifact: "art_laser_linearity_csv"
      details: "Single sweep after 10-minute warm-up."
  stability_series:
    - laser: "488"
      setpoint: 80
      setpoint_units: "percent"
      sampling: "1 Hz for 5 min"
      power_units: "mW"
      timepoints:
        - t_s: 0
          power: 1.75
        - t_s: 120
          power: 1.74
        - t_s: 300
          power: 1.75
      details: "Short-term stability check for trend continuity."

computed_provenance:
  pipeline: "aic_qc_pipeline"
  version: "1.4.0"
  git_commit: "7c4a9d1"
  run_utc: "2025-09-02T16:20:00Z"

metrics_computed:
  - metric_id: "laser.488.linearity_r2"
    value: 0.997
    unit: "unitless"
  - metric_id: "psf.60x_oil.525.fwhm_xy_max_nm"
    value: 240
    unit: "nm"
  - metric_id: "psf.60x_oil.525.fwhm_xy_min_nm"
    value: 240
    unit: "nm"
  - metric_id: "psf.60x_oil.525.fwhm_z_nm"
    value: 620
    unit: "nm"
  - metric_id: "chromatic_shift.60x_oil.561_to_488.dist_nm"
    value: 90
    unit: "nm"
  - metric_id: "stage.repeatability_sigma_x_nm"
    value: 230
    unit: "nm"
  - metric_id: "stage.repeatability_sigma_y_nm"
    value: 240
    unit: "nm"

evaluation:
  benchmark_ref: "benchmarks/scope-testx1.yaml@main"
  evaluated_utc: "2025-09-02T16:20:00Z"
  evaluated_by: "github_action:qceval"
  overall_status: "warn"
  results:
    - metric_id: "psf.60x_oil.525.fwhm_z_nm"
      status: "warn"
      threshold: "warn>600nm, fail>750nm"
      message: "561 stability exceeded warning/fail limits; driver replacement scheduled next morning."

artifacts:
  - artifact_id: "art_laser_linearity_csv"
    role: "table"
    uri: "omero://aic-core/scope-testx1/2025/dataset/qc_scope-testx1_20250902T1530Z_intensity_v1/laser_linearity.csv"
    description: "Laser setpoint sweep."
  - artifact_id: "art_laser_stability_csv"
    role: "table"
    uri: "omero://aic-core/scope-testx1/2025/dataset/qc_scope-testx1_20250902T1530Z_intensity_v1/laser_stability.csv"
    description: "Laser stability time series."
  - artifact_id: "art_psf_stack_raw"
    role: "raw_image"
    uri: "omero://aic-core/scope-testx1/2025/image/qc_scope-testx1_20250902T1530Z_intensity_v1_psf"
    description: "PSF bead stack."
  - artifact_id: "art_psf_preview"
    role: "preview"
    uri: "qc/sessions/scope-testx1/2025/previews/qc_scope-testx1_20250902T1530Z_intensity_v1_psf_mip.png"
    description: "PSF MIP preview."
  - artifact_id: "art_coreg_stack_raw"
    role: "raw_image"
    uri: "omero://aic-core/scope-testx1/2025/image/qc_scope-testx1_20250902T1530Z_intensity_v1_coreg"
    description: "Co-registration stack."
  - artifact_id: "art_coreg_preview"
    role: "preview"
    uri: "qc/sessions/scope-testx1/2025/previews/qc_scope-testx1_20250902T1530Z_intensity_v1_coreg_overlay.png"
    description: "Co-registration overlay preview."
  - artifact_id: "art_stage_repeat_raw"
    role: "raw_image"
    uri: "omero://aic-core/scope-testx1/2025/image/qc_scope-testx1_20250902T1530Z_intensity_v1_stage"
    description: "Stage repeatability acquisition."
  - artifact_id: "art_stage_repeat_plot"
    role: "preview"
    uri: "qc/sessions/scope-testx1/2025/previews/qc_scope-testx1_20250902T1530Z_intensity_v1_stage_repeat.png"
    description: "Stage repeatability plot."
