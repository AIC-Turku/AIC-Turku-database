# ğŸ”¬ {{ instrument.display_name }}

<div class="aic-topactions" markdown="span">
  [ğŸ“Š View QC & Maintenance History](history.md){ .md-button .md-button--primary }
</div>

{% set status_class = 'success' if instrument.status.color == 'green' else 'warning' if instrument.status.color == 'yellow' else 'danger' %}
!!! {{ status_class }} "Current Status: {{ instrument.status.badge }}"
    {{ instrument.status.reason }}

<div class="aic-hero">
  <div class="aic-hero__media">
    <img src="../../assets/images/{{ instrument.image_filename }}" alt="{{ instrument.display_name }}"
         onerror="this.onerror=null; this.src='../../assets/images/placeholder.svg';" />
  </div>

  <div class="aic-hero__facts">
    <div class="aic-facts">
      <div class="aic-fact">
        <div class="aic-muted">ğŸ·ï¸ Instrument ID</div>
        <div><code>{{ instrument.id }}</code></div>
      </div>
      <div class="aic-fact">
        <div class="aic-muted">ğŸ­ Manufacturer</div>
        <div>{{ instrument.manufacturer or 'â€”' }}</div>
      </div>
      <div class="aic-fact">
        <div class="aic-muted">âš™ï¸ Model</div>
        <div>{{ instrument.model or 'â€”' }}</div>
      </div>
      <div class="aic-fact">
        <div class="aic-muted">ğŸ“ Stand</div>
        <div>{{ instrument.stand_orientation or 'â€”' }}</div>
      </div>
    </div>

    <div class="aic-section">
      <div class="aic-section__title">ğŸŒˆ Modalities</div>
      <div class="aic-chiprow">
        {% for mod in instrument.modalities %}
          <span class="aic-chip">{{ mod }}</span>
        {% else %}
          <span class="aic-muted">ğŸ“­ â€”</span>
        {% endfor %}
      </div>
    </div>

    {% if instrument.modules %}
    <div class="aic-section">
      <div class="aic-section__title">ğŸ§© Modules</div>
      <div class="aic-chiprow">
        {% for m in instrument.modules %}
          <span class="aic-chip aic-chip--muted">{{ m }}</span>
        {% endfor %}
      </div>
    </div>
    {% endif %}

  </div>
</div>

{% if instrument.notes %}
## ğŸ“ Capabilities (legacy notes)

{% if instrument.notes.type %}
- **Type:** {{ instrument.notes.type }}
{% endif %}

{% if instrument.notes.imaging_modes %}
- **Imaging modes:** {{ instrument.notes.imaging_modes | join(', ') }}
{% endif %}

{% if instrument.notes.filters %}
- **Filters:**
{% for f in instrument.notes.filters %}
  - {{ f }}
{% endfor %}
{% endif %}

{% if instrument.notes.additional_hardware %}
- **Additional hardware:**
{% for h in instrument.notes.additional_hardware %}
  - {{ h }}
{% endfor %}
{% endif %}

{% if instrument.notes.raw %}
- **Notes:** {{ instrument.notes.raw }}
{% endif %}
{% endif %}

## ğŸ’» Software Environment

{% if instrument.software %}

| Component | Name | Version |
|---|---|---|
{% for sw in instrument.software -%}
| {{ sw.component or 'â€”' }} | **{{ sw.name or 'â€”' }}** | `{{ sw.version or 'â€”' }}` |
{% endfor %}

{% else %}
> ğŸ“­ *No software configurations recorded.*
{% endif %}

## ğŸ› ï¸ Hardware

### ğŸ’¡ Light Sources

| Model | Type | Wavelength (nm) | Notes |
|---|---|---:|---|
{% for src in light_sources -%}
| **{{ src.name or 'â€”' }}** | {{ src.type or 'â€”' }} | {{ src.wavelength if src.wavelength is not none else 'â€”' }} | {{ src.notes or 'â€”' }} |
{% else -%}
| â€” | â€” | â€” | â€” |
{% endfor %}

### ğŸ“· Detectors

| Manufacturer | Model | Type | Notes |
|---|---|---|---|
{% for det in detectors -%}
| **{{ det.name or 'â€”' }}** | {{ det.model or 'â€”' }} | {{ det.type or 'â€”' }} | {{ det.notes or 'â€”' }} |
{% else -%}
| â€” | â€” | â€” | â€” |
{% endfor %}

### ğŸ” Objectives

| Model | Magnification | N.A. | Notes |
|---|---:|---:|---|
{% for obj in objectives -%}
| **{{ obj.name or 'â€”' }}** | {{ obj.magnification if obj.magnification is not none else 'â€”' }}x | {{ obj.na if obj.na is not none else 'â€”' }} | {{ obj.notes or 'â€”' }} |
{% else -%}
| â€” | â€” | â€” | â€” |
{% endfor %}

## ğŸ“ Latest QC Measurements

| Metric | Value |
|---|---|
{% for m_id, m_val in latest_metrics.items() -%}
| **{{ metric_names.get(m_id, m_id) }}** <br><span class="aic-muted"><code>{{ m_id }}</code></span> | <code>{{ m_val }}</code> |
{% else -%}
| â€” | â€” |
{% endfor %}
