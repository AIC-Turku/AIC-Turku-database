---
hide:
  - navigation
  - toc
---

# ğŸ“ Event: {{ event_id }}

<div class="aic-topactions" markdown="span">
  <!-- Use markdown source targets for GitHub Pages + use_directory_urls compatibility. -->
  [ğŸ”™ Back to Overview](../../instruments/{{ instrument_id }}/index.md){ .md-button }
  [ğŸ“Š View Full History](../../instruments/{{ instrument_id }}/history.md){ .md-button .md-button--primary }
</div>

{% set record_type = payload.get('record_type', '') | lower %}
{% set is_maintenance = record_type.startswith('maintenance') %}
{% set reason_or_suite = payload.get('reason') or payload.get('type') or payload.get('reason_details') or 'â€”' %}
{% set maintenance_reason_details = payload.get('reason_details') or payload.get('reason') or 'â€”' %}
{% set maintenance_action_details = payload.get('action_details') or payload.get('action') or 'â€”' %}

## ğŸ“Š Report Overview

<div class="aic-grid">

  <div class="aic-card">
    <div class="aic-card__body">
      <div class="aic-card__title">Event Metadata</div>
      <div class="aic-kv">
        <div><span class="aic-muted">Record Type</span><br>{{ payload.get('record_type', 'â€”') | replace('_', ' ') | title }}</div>
        <div><span class="aic-muted">Reason / Suite</span><br>{{ reason_or_suite | string | title }}</div>
        
        {% if is_maintenance %}
        <div><span class="aic-muted">Service Provider</span><br>{{ payload.get('service_provider', 'â€”') }}</div>
        {% else %}
        <div><span class="aic-muted">Operator</span><br>{{ operator | default('â€”', true) }}</div>
        {% endif %}
        
        <div><span class="aic-muted">Instrument</span><br><code>{{ instrument | default(instrument_id, true) }}</code></div>
      </div>
    </div>
  </div>

  {% if payload.get('record_type') == 'qc_session' or payload.get('evaluation') %}
  <div class="aic-card">
    <div class="aic-card__body">
      <div class="aic-card__title">QC Summary & Evaluation</div>
      
      {% if payload.get('summary') %}
        <p style="font-size: 0.95rem; margin-bottom: 0.8rem;"><strong>Summary:</strong> {{ payload.get('summary') }}</p>
      {% endif %}

      {% set eval = payload.get('evaluation', {}) %}
      {% if eval %}
        {% set status = eval.get('overall_status', 'unknown') %}
        {% set badge_color = 'green' if status == 'pass' else 'yellow' if status == 'warn' else 'red' if status == 'fail' else 'gray' %}
        
        <div style="margin: 0.5rem 0 1rem;">
          <span class="aic-badge aic-badge--{{ badge_color }}">{{ status | upper }}</span>
        </div>
        
        {% if eval.get('results') %}
          {% for res in eval.get('results', []) %}
            <div style="font-size: 0.9rem; margin-bottom: 0.4rem;">
              <strong>{{ res.get('metric_id', 'Rule') }}</strong>: {{ res.get('message', '') }}
            </div>
          {% endfor %}
        {% endif %}
      {% endif %}
    </div>
  </div>
  {% endif %}

  {% if is_maintenance or payload.get('action') or payload.get('action_details') %}
  <div class="aic-card">
    <div class="aic-card__body">
      <div class="aic-card__title">Maintenance Action</div>

      {% if is_maintenance %}
      <div style="font-size: 0.95rem; margin-bottom: 0.6rem;">
        <strong>Reason Details:</strong><br>
        {{ maintenance_reason_details }}
      </div>
      <div style="font-size: 0.95rem; margin-bottom: 0.5rem;">
        <strong>Action Details:</strong><br>
        {{ maintenance_action_details }}
      </div>
      {% else %}
      <p style="font-size: 0.95rem; margin-bottom: 0.5rem;">{{ payload.get('action', payload.get('action_details', 'â€”')) }}</p>
      {% endif %}
      
      {% if payload.get('microscope_status_after') %}
      <div style="margin-top: 1rem;">
        <span class="aic-muted" style="font-size: 0.85rem;">Status After Fix:</span><br>
        <code>{{ payload.get('microscope_status_after', 'â€”') | upper }}</code>
      </div>
      {% endif %}
    </div>
  </div>
  {% endif %}

</div>

{% if payload.get('performed') %}
## ğŸ”¬ Tests Performed

| Test Type | Details |
|---|---|
{% for task in payload.get('performed', []) %}| **{{ task.get('qc_type', 'â€”') | replace('_', ' ') | title }}** | {{ task.get('details', 'â€”') }} |
{% endfor %}

{% endif %}

{% if payload.get('metrics_computed') %}
## ğŸ“ Computed Metrics

| Metric ID | Value |
|---|---|
{% for m in payload.get('metrics_computed', []) %}| <code>{{ m.get('metric_id') }}</code> | **{{ m.get('value') }}** |
{% endfor %}

{% endif %}

{% if payload.get('artifacts') %}
## ğŸ“ Artifacts & References

| Artifact ID | Role | Description |
|---|---|---|
{% for art in payload.get('artifacts', []) %}| <code>{{ art.get('artifact_id', 'â€”') }}</code> | <span class="aic-chip">{{ art.get('role', 'â€”') | upper }}</span> | {% if art.get('uri') %}[{{ art.get('description', 'Link') }}]({{ art.get('uri') }}){% else %}{{ art.get('description', 'â€”') }}{% endif %} |
{% endfor %}

{% endif %}

{% if payload.get('notes') %}
!!! quote "Additional Notes"
    {{ payload.get('notes') }}

{% endif %}

## ğŸ“„ Raw YAML Ledger

??? quote "View `{{ event_id }}.yaml`"

    ```yaml
{{ raw_yaml_content | indent(4, true) }}
    ```
